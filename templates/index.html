<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🌿 Plant Medic | AI Medicinal Plant Identifier</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'inter': ['Inter', 'sans-serif'],
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'fade-in': 'fadeIn 0.6s ease-in-out',
                        'slide-up': 'slideUp 0.8s ease-out',
                        'bounce-slow': 'bounce 2s infinite',
                        'float': 'float 6s ease-in-out infinite',
                        'glow': 'glow 2s ease-in-out infinite alternate',
                        'slide-in-right': 'slideInRight 0.8s ease-out',
                        'scale-in': 'scaleIn 0.6s ease-out',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(30px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        },
                        float: {
                            '0%, 100%': { transform: 'translateY(0px)' },
                            '50%': { transform: 'translateY(-10px)' },
                        },
                        glow: {
                            '0%': { boxShadow: '0 0 20px rgba(74, 222, 128, 0.3)' },
                            '100%': { boxShadow: '0 0 30px rgba(74, 222, 128, 0.6)' },
                        },
                        slideInRight: {
                            '0%': { transform: 'translateX(50px)', opacity: '0' },
                            '100%': { transform: 'translateX(0)', opacity: '1' },
                        },
                        scaleIn: {
                            '0%': { transform: 'scale(0.9)', opacity: '0' },
                            '100%': { transform: 'scale(1)', opacity: '1' },
                        }
                    },
                    colors: {
                        'primary': {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                        },
                        'green': {
                            50: '#f0fdf4',
                            100: '#dcfce7',
                            500: '#22c55e',
                            600: '#16a34a',
                            700: '#15803d',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        * {
            font-family: 'Inter', sans-serif;
        }
        
        .glass {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.8);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .glass-dark {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.6);
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .upload-area {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            background: rgba(255, 255, 255, 0.8);
            border: 2px dashed #cbd5e1;
        }
        
        .upload-area.dragover {
            border-color: #22c55e;
            background-color: rgba(34, 197, 94, 0.1);
            transform: scale(1.02);
        }
        
        .result-card {
            opacity: 0;
            transform: translateY(30px) scale(0.95);
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .result-card.show {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
        
        .medicine-item {
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.7);
        }
        
        .medicine-item:hover {
            transform: translateX(8px);
            background: rgba(255, 255, 255, 0.9);
        }
        
        .floating-shapes {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 0;
        }
        
        .floating-shape {
            position: absolute;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            animation: float 8s ease-in-out infinite;
        }
        
        .confidence-high { 
            background: linear-gradient(135deg, #22c55e, #16a34a);
            color: white;
        }
        .confidence-medium { 
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }
        .confidence-low { 
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
        }
        
        .loading-dots:after {
            content: '';
            animation: dots 1.5s steps(5, end) infinite;
        }
        
        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }
        
        .gradient-text {
            background: linear-gradient(135deg, #22c55e, #0ea5e9);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .hover-lift {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .hover-lift:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }
        
        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #22c55e, #0ea5e9);
            border-radius: 10px;
        }
        
        /* Pulse animation for health status */
        @keyframes pulse-glow {
            0%, 100% { 
                transform: scale(1);
                box-shadow: 0 0 5px currentColor;
            }
            50% { 
                transform: scale(1.1);
                box-shadow: 0 0 20px currentColor;
            }
        }
        
        .pulse-glow {
            animation: pulse-glow 2s ease-in-out infinite;
        }

        /* Text colors for better readability */
        .text-primary {
            color: #1f2937;
        }
        
        .text-secondary {
            color: #4b5563;
        }
        
        .text-muted {
            color: #6b7280;
        }
    </style>
</head>
<body class="gradient-bg min-h-screen flex flex-col font-inter relative">
    <!-- Floating Background Shapes -->
    <div class="floating-shapes">
        <div class="floating-shape w-64 h-64 -top-32 -left-32 bg-white bg-opacity-10" style="animation-delay: 0s;"></div>
        <div class="floating-shape w-48 h-48 top-1/4 -right-24 bg-white bg-opacity-10" style="animation-delay: 1s;"></div>
        <div class="floating-shape w-32 h-32 bottom-32 left-1/4 bg-white bg-opacity-10" style="animation-delay: 2s;"></div>
        <div class="floating-shape w-40 h-40 bottom-20 right-1/3 bg-white bg-opacity-10" style="animation-delay: 3s;"></div>
    </div>

    <!-- Header - Updated Color -->
    <header class="bg-gradient-to-r from-green-600 to-blue-700 rounded-3xl m-6 p-8 shadow-2xl animate-slide-up relative z-10">
        <div class="container mx-auto flex flex-col lg:flex-row justify-between items-center">
            <div class="flex items-center space-x-6 mb-6 lg:mb-0">
                <div class="bg-white bg-opacity-20 p-4 rounded-2xl shadow-2xl hover-lift">
                    <i class="fas fa-leaf text-white text-3xl"></i>
                </div>
                <div>
                    <h1 class="text-4xl lg:text-5xl font-bold text-white mb-2">Plant Medic</h1>
                    <p class="text-white text-opacity-90 text-lg">AI-Powered Medicinal Plant Identifier & Health Advisor</p>
                </div>
            </div>
            <div class="flex items-center space-x-4 bg-white bg-opacity-20 rounded-2xl px-6 py-3 animate-scale-in">
                <div id="health-status" class="w-4 h-4 rounded-full bg-red-500 pulse-glow"></div>
                <div class="text-white">
                    <span class="text-sm font-medium">API Status:</span>
                    <span id="health-text" class="font-semibold ml-2">Checking...</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow container mx-auto px-4 py-8 animate-fade-in relative z-10">
        <div class="grid grid-cols-1 xl:grid-cols-2 gap-8 max-w-7xl mx-auto">
            <!-- Upload Section -->
            <div class="glass rounded-3xl shadow-2xl p-8 hover-lift transition-all duration-500">
                <div class="flex items-center space-x-3 mb-6">
                    <div class="bg-blue-500 p-3 rounded-xl">
                        <i class="fas fa-cloud-upload-alt text-white text-xl"></i>
                    </div>
                    <div>
                        <h2 class="text-2xl font-bold text-primary">Upload Plant Image</h2>
                        <p class="text-secondary">Discover medicinal properties of plants</p>
                    </div>
                </div>
                
                <div id="upload-area" class="upload-area rounded-2xl p-12 text-center cursor-pointer mb-8 group border-2 border-dashed border-gray-300">
                    <i class="fas fa-cloud-upload-alt text-6xl text-gray-400 mb-6 group-hover:scale-110 transition-transform duration-300"></i>
                    <p class="text-xl text-primary mb-3 font-medium">Drag & Drop Your Image</p>
                    <p class="text-muted">or click to browse • PNG, JPG, JPEG • Max 10MB</p>
                    <input type="file" id="file-input" class="hidden" accept="image/*">
                </div>
                
                <div id="image-preview" class="hidden mb-8 rounded-2xl overflow-hidden shadow-2xl animate-scale-in border-2 border-gray-200">
                    <div class="relative">
                        <img id="preview-img" class="w-full h-80 object-cover" src="" alt="Preview">
                        <div class="absolute top-4 right-4 bg-black bg-opacity-50 text-white px-3 py-1 rounded-full text-sm">
                            <i class="fas fa-image mr-1"></i> Preview
                        </div>
                    </div>
                </div>
                
                <button id="predict-btn" class="w-full bg-gradient-to-r from-green-500 to-blue-600 hover:from-green-600 hover:to-blue-700 text-white font-bold py-4 px-6 rounded-2xl shadow-2xl transition-all duration-300 transform hover:scale-105 active:scale-95 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none" disabled>
                    <i class="fas fa-search mr-3"></i> 
                    <span id="predict-text">Identify Medicinal Plant</span>
                </button>
                
                <div id="loading-indicator" class="hidden mt-6 text-center animate-pulse">
                    <div class="inline-flex items-center bg-green-50 px-6 py-3 rounded-2xl border border-green-200">
                        <i class="fas fa-spinner fa-spin mr-3 text-green-600"></i>
                        <span class="text-green-800 font-medium">Identifying plant species<span class="loading-dots"></span></span>
                    </div>
                </div>

                <!-- Quick Tips -->
                <div class="mt-8 bg-yellow-50 rounded-2xl p-6 animate-fade-in border border-yellow-200">
                    <h3 class="text-lg font-semibold text-yellow-800 flex items-center mb-4">
                        <i class="fas fa-lightbulb text-yellow-600 mr-3"></i> Pro Tips
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                        <div class="flex items-center space-x-2 text-yellow-700">
                            <i class="fas fa-check-circle text-green-500 text-sm"></i>
                            <span class="text-sm">Clear, well-lit images</span>
                        </div>
                        <div class="flex items-center space-x-2 text-yellow-700">
                            <i class="fas fa-check-circle text-green-500 text-sm"></i>
                            <span class="text-sm">Focus on leaf details</span>
                        </div>
                        <div class="flex items-center space-x-2 text-yellow-700">
                            <i class="fas fa-check-circle text-green-500 text-sm"></i>
                            <span class="text-sm">Multiple angles help</span>
                        </div>
                        <div class="flex items-center space-x-2 text-yellow-700">
                            <i class="fas fa-check-circle text-green-500 text-sm"></i>
                            <span class="text-sm">Natural light works best</span>
                        </div>
                    </div>
                </div>

                <!-- Model Information Section -->
                <div class="mt-8 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-6 animate-fade-in border border-blue-200">
                    <h3 class="text-lg font-semibold text-blue-800 flex items-center justify-between mb-4">
                        <span>
                            <i class="fas fa-brain text-blue-600 mr-3"></i> Model Information
                        </span>
                        <button id="refresh-model-info" class="text-blue-600 hover:text-blue-800 transition-colors">
                            <i class="fas fa-refresh"></i>
                        </button>
                    </h3>
                    <div class="grid grid-cols-2 gap-4 text-sm">
                        <div class="flex flex-col">
                            <span class="text-blue-700 font-medium">Status:</span>
                            <span id="model-status" class="font-semibold text-blue-800 mt-1">Loading...</span>
                        </div>
                        <div class="flex flex-col">
                            <span class="text-blue-700 font-medium">Classes:</span>
                            <span id="model-classes" class="font-semibold text-blue-800 mt-1">-</span>
                        </div>
                        <div class="flex flex-col">
                            <span class="text-blue-700 font-medium">Accuracy:</span>
                            <span id="model-accuracy" class="font-semibold text-blue-800 mt-1">-</span>
                        </div>
                        <div class="flex flex-col">
                            <span class="text-blue-700 font-medium">Last Trained:</span>
                            <span id="model-trained" class="font-semibold text-blue-800 mt-1">-</span>
                        </div>
                    </div>
                    <div class="mt-4 pt-4 border-t border-blue-200">
                        <div class="flex flex-col">
                            <span class="text-blue-700 font-medium">Medicinal Plants Database:</span>
                            <span id="medicinal-plants-count" class="font-semibold text-blue-800 mt-1">-</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Results Section -->
            <div class="glass rounded-3xl shadow-2xl p-8 hover-lift transition-all duration-500">
                <div class="flex items-center space-x-3 mb-6">
                    <div class="bg-green-500 p-3 rounded-xl">
                        <i class="fas fa-clipboard-list text-white text-xl"></i>
                    </div>
                    <div>
                        <h2 class="text-2xl font-bold text-primary">Analysis Results</h2>
                        <p class="text-secondary">Detailed medicinal insights & health benefits</p>
                    </div>
                </div>
                
                <div id="results-container" class="space-y-6 max-h-[1200px] overflow-y-auto pr-2">
                    <!-- Empty State -->
                    <div id="empty-state" class="text-center py-16 animate-pulse">
                        <div class="flex justify-center mb-6">
                            <div class="relative">
                                <i class="fas fa-leaf text-6xl text-gray-300"></i>
                                <div class="absolute inset-0 animate-pulse">
                                    <i class="fas fa-circle text-green-400 text-opacity-20"></i>
                                </div>
                            </div>
                        </div>
                        <h3 class="text-xl font-semibold text-primary mb-3">Ready for Analysis</h3>
                        <p class="text-secondary mb-2">Upload a plant image to discover its medicinal properties</p>
                        <p class="text-muted text-sm">Get Ayurvedic insights and health benefits</p>
                    </div>
                    
                    <!-- Results Content -->
                    <div id="results-content" class="hidden space-y-6">
                        <!-- Confidence Alert -->
                        <div id="confidence-alert" class="hidden rounded-2xl p-5 border-2 bg-yellow-50 border-yellow-400"></div>

                        <!-- Plant Identification -->
                        <div class="result-card bg-white rounded-2xl p-6 shadow-lg border border-gray-200">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-xl font-bold text-primary">Plant Identification</h3>
                                <div class="flex space-x-2">
                                    <span id="confidence-badge" class="text-xs font-bold px-3 py-1.5 rounded-full text-white shadow-lg"></span>
                                </div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h4 id="plant-common-name" class="text-2xl font-bold gradient-text mb-2"></h4>
                                    <p id="plant-hindi-name" class="text-green-700 font-medium mb-1"></p>
                                    <p id="plant-scientific-name" class="text-muted text-sm mb-3"></p>
                                    <p id="plant-family" class="text-secondary text-sm"></p>
                                </div>
                                <div class="space-y-3">
                                    <div class="flex justify-between items-center py-2 border-b border-gray-200">
                                        <span class="text-secondary">Health Level:</span>
                                        <span id="confidence-score" class="font-bold text-primary"></span>
                                    </div>
                                    <div class="flex justify-between items-center py-2 border-b border-gray-200">
                                        <span class="text-secondary">Detected Class:</span>
                                        <span id="detected-class" class="font-bold text-primary text-sm"></span>
                                    </div>
                                    <div class="flex justify-between items-center py-2 border-b border-gray-200">
                                        <span class="text-secondary">Family:</span>
                                        <span id="plant-family-badge" class="font-bold text-primary text-sm"></span>
                                    </div>
                                </div>
                            </div>
                            <p id="plant-description" class="text-secondary mt-4 leading-relaxed"></p>
                        </div>

                        <!-- Medicinal Properties -->
                        <div class="result-card bg-white rounded-2xl p-6 shadow-lg border border-gray-200">
                            <div class="flex items-center space-x-3 mb-4">
                                <div class="bg-purple-500 p-2 rounded-lg">
                                    <i class="fas fa-seedling text-white"></i>
                                </div>
                                <h3 class="text-xl font-bold text-primary">Medicinal Properties</h3>
                            </div>
                            
                            <!-- Ayurvedic Properties -->
                            <div class="mb-6">
                                <h5 class="text-lg font-semibold text-primary mb-3 flex items-center">
                                    <i class="fas fa-star text-yellow-500 mr-2"></i> Ayurvedic Properties
                                </h5>
                                <div id="ayurvedic-properties" class="grid grid-cols-2 md:grid-cols-4 gap-3"></div>
                            </div>

                            <!-- Medicinal Uses -->
                            <div class="mb-6">
                                <h5 class="text-lg font-semibold text-primary mb-3 flex items-center">
                                    <i class="fas fa-heart text-red-500 mr-2"></i> Medicinal Uses
                                </h5>
                                <div id="medicinal-uses" class="space-y-2"></div>
                            </div>

                            <!-- Health Benefits -->
                            <div class="mb-6">
                                <h5 class="text-lg font-semibold text-primary mb-3 flex items-center">
                                    <i class="fas fa-shield-alt text-blue-500 mr-2"></i> Health Benefits
                                </h5>
                                <div id="health-benefits" class="space-y-2"></div>
                            </div>

                            <!-- How to Use -->
                            <div class="mb-6">
                                <h5 class="text-lg font-semibold text-primary mb-3 flex items-center">
                                    <i class="fas fa-book-medical text-green-500 mr-2"></i> How to Use
                                </h5>
                                <div id="how-to-use" class="space-y-2"></div>
                            </div>

                            <!-- Precautions -->
                            <div>
                                <h5 class="text-lg font-semibold text-primary mb-3 flex items-center">
                                    <i class="fas fa-exclamation-triangle text-orange-500 mr-2"></i> Precautions
                                </h5>
                                <div id="precautions" class="space-y-2"></div>
                            </div>
                        </div>

                        <!-- Analysis Details -->
                        <div class="result-card bg-white rounded-2xl p-6 shadow-lg border border-gray-200">
                            <h3 class="text-xl font-bold text-primary mb-4 flex items-center">
                                <i class="fas fa-chart-bar text-blue-500 mr-3"></i> Analysis Details
                            </h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="space-y-3">
                                    <div class="flex justify-between items-center py-2 border-b border-gray-200">
                                        <span class="text-secondary">Confidence Level</span>
                                        <span id="confidence-level" class="font-semibold text-primary"></span>
                                    </div>
                                    <div class="flex justify-between items-center py-2 border-b border-gray-200">
                                        <span class="text-secondary">Analysis Type</span>
                                        <span class="font-semibold text-primary">Medicinal Plant Identification</span>
                                    </div>
                                </div>
                                <div class="space-y-3">
                                    <div class="flex justify-between items-center py-2 border-b border-gray-200">
                                        <span class="text-secondary">Timestamp</span>
                                        <span id="timestamp" class="font-semibold text-primary text-sm"></span>
                                    </div>
                                    <div class="flex justify-between items-center py-2 border-b border-gray-200">
                                        <span class="text-secondary">File Name</span>
                                        <span id="filename" class="font-semibold text-primary text-sm truncate"></span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="result-card flex space-x-4">
                            <button id="new-analysis-btn" class="flex-1 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-bold py-4 px-6 rounded-2xl shadow-2xl transition-all duration-300 transform hover:scale-105 active:scale-95 flex items-center justify-center">
                                <i class="fas fa-plus mr-3"></i> New Analysis
                            </button>
                            <button id="save-report-btn" class="flex-1 bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700 text-white font-bold py-4 px-6 rounded-2xl shadow-2xl transition-all duration-300 transform hover:scale-105 active:scale-95 flex items-center justify-center">
                                <i class="fas fa-download mr-3"></i> Save Report
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gradient-to-r from-green-600 to-blue-700 mt-12 py-6 relative z-10">
        <div class="container mx-auto px-4 text-center">
            <p class="text-white font-medium">
                🌿 Plant Medic &copy; 2024 | AI-Powered Medicinal Plant Identification
            </p>
            <p class="text-white text-opacity-90 text-sm mt-2">
                Combining Traditional Ayurvedic Wisdom with Modern AI Technology
            </p>
        </div>
    </footer>

    <!-- Toast Notifications -->
    <div id="toast" class="fixed bottom-6 right-6 bg-red-500 text-white px-6 py-4 rounded-2xl shadow-2xl transform translate-y-16 transition-all duration-500 z-50 hidden">
        <div class="flex items-center space-x-3">
            <i class="fas fa-exclamation-circle text-xl"></i>
            <span id="toast-message" class="font-medium"></span>
        </div>
    </div>

    <div id="success-toast" class="fixed bottom-6 right-6 bg-green-500 text-white px-6 py-4 rounded-2xl shadow-2xl transform translate-y-16 transition-all duration-500 z-50 hidden">
        <div class="flex items-center space-x-3">
            <i class="fas fa-check-circle text-xl"></i>
            <span id="success-message" class="font-medium"></span>
        </div>
    </div>

    <script>
        // API Configuration
        const API_BASE = 'http://localhost:4000';
        
        // DOM Elements
        const uploadArea = document.getElementById('upload-area');
        const fileInput = document.getElementById('file-input');
        const previewImg = document.getElementById('preview-img');
        const imagePreview = document.getElementById('image-preview');
        const predictBtn = document.getElementById('predict-btn');
        const predictText = document.getElementById('predict-text');
        const loadingIndicator = document.getElementById('loading-indicator');
        const emptyState = document.getElementById('empty-state');
        const resultsContent = document.getElementById('results-content');
        const toast = document.getElementById('toast');
        const successToast = document.getElementById('success-toast');
        const healthStatus = document.getElementById('health-status');
        const healthText = document.getElementById('health-text');
        const confidenceAlert = document.getElementById('confidence-alert');
        const newAnalysisBtn = document.getElementById('new-analysis-btn');
        const saveReportBtn = document.getElementById('save-report-btn');
        const refreshModelInfo = document.getElementById('refresh-model-info');
        
        // Model Information Elements
        const modelStatus = document.getElementById('model-status');
        const modelClasses = document.getElementById('model-classes');
        const modelAccuracy = document.getElementById('model-accuracy');
        const modelTrained = document.getElementById('model-trained');
        const medicinalPlantsCount = document.getElementById('medicinal-plants-count');
        
        // Result Elements
        const plantCommonName = document.getElementById('plant-common-name');
        const plantHindiName = document.getElementById('plant-hindi-name');
        const plantScientificName = document.getElementById('plant-scientific-name');
        const plantFamily = document.getElementById('plant-family');
        const plantFamilyBadge = document.getElementById('plant-family-badge');
        const plantDescription = document.getElementById('plant-description');
        const detectedClass = document.getElementById('detected-class');
        const confidenceBadge = document.getElementById('confidence-badge');
        const confidenceScore = document.getElementById('confidence-score');
        const confidenceLevel = document.getElementById('confidence-level');
        const timestamp = document.getElementById('timestamp');
        const filename = document.getElementById('filename');
        const ayurvedicProperties = document.getElementById('ayurvedic-properties');
        const medicinalUses = document.getElementById('medicinal-uses');
        const healthBenefits = document.getElementById('health-benefits');
        const howToUse = document.getElementById('how-to-use');
        const precautions = document.getElementById('precautions');
        
        // Event Listeners
        uploadArea.addEventListener('click', () => fileInput.click());
        uploadArea.addEventListener('dragover', handleDragOver);
        uploadArea.addEventListener('dragleave', handleDragLeave);
        uploadArea.addEventListener('drop', handleDrop);
        fileInput.addEventListener('change', handleFileSelect);
        predictBtn.addEventListener('click', predictPlant);
        newAnalysisBtn.addEventListener('click', resetAnalysis);
        saveReportBtn.addEventListener('click', saveReport);
        refreshModelInfo.addEventListener('click', loadModelInfo);
        
        // Initialize
        checkAPIHealth();
        loadModelInfo();
        setInterval(checkAPIHealth, 10000);
        createFloatingShapes();
        
        // Functions
        function handleDragOver(e) {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        }
        
        function handleDragLeave(e) {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
        }
        
        function handleDrop(e) {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            
            if (e.dataTransfer.files.length) {
                fileInput.files = e.dataTransfer.files;
                handleFileSelect();
            }
        }
        
        function handleFileSelect() {
            if (fileInput.files && fileInput.files[0]) {
                const file = fileInput.files[0];
                
                // Validate file size (max 10MB)
                if (file.size > 10 * 1024 * 1024) {
                    showToast('File size exceeds 10MB limit. Please choose a smaller file.');
                    return;
                }
                
                // Validate file type
                if (!file.type.match('image.*')) {
                    showToast('Please select an image file (JPEG, PNG, etc.).');
                    return;
                }
                
                // Preview image
                const reader = new FileReader();
                reader.onload = function(e) {
                    previewImg.src = e.target.result;
                    imagePreview.classList.remove('hidden');
                    imagePreview.classList.add('animate-scale-in');
                    predictBtn.disabled = false;
                };
                reader.readAsDataURL(file);
            }
        }
        
        async function predictPlant() {
            if (!fileInput.files.length) {
                showToast('Please select an image first.');
                return;
            }
            
            const file = fileInput.files[0];
            const formData = new FormData();
            formData.append('image', file);
            
            // Show loading state
            predictBtn.disabled = true;
            predictText.textContent = 'Identifying...';
            loadingIndicator.classList.remove('hidden');
            
            try {
                const response = await fetch(`${API_BASE}/predict`, {
                    method: 'POST',
                    body: formData
                });
                
                if (!response.ok) {
                    throw new Error(`Server error: ${response.status}`);
                }
                
                const data = await response.json();
                
                if (data.status === 200) {
                    displayResults(data);
                    showSuccess('Plant identified successfully! 🍃');
                } else {
                    showToast(data.message || 'Error processing image.');
                }
            } catch (error) {
                console.error('Prediction error:', error);
                handlePredictionError(error);
            } finally {
                loadingIndicator.classList.add('hidden');
                predictBtn.disabled = false;
                predictText.textContent = 'Identify Medicinal Plant';
            }
        }
        
        function handlePredictionError(error) {
            if (error.message.includes('Server error: 500')) {
                showToast('Model prediction failed. Please try a different image.');
            } else if (error.message.includes('Server error: 400')) {
                showToast('Invalid image format. Please try with a different image.');
            } else if (error.message.includes('Failed to fetch')) {
                showToast('Cannot connect to server. Make sure backend is running on localhost:4000');
            } else {
                showToast('Identification failed: ' + error.message);
            }
        }
        
        function displayResults(data) {
            // Hide empty state, show results
            emptyState.classList.add('hidden');
            resultsContent.classList.remove('hidden');
            
            // Plant Identification Information
            const plantId = data.plant_identification;
            plantCommonName.textContent = plantId.common_name;
            plantHindiName.textContent = plantId.hindi_name;
            plantScientificName.textContent = plantId.scientific_name;
            plantFamily.textContent = `Family: ${plantId.family}`;
            plantFamilyBadge.textContent = plantId.family;
            plantDescription.textContent = plantId.description;
            detectedClass.textContent = plantId.detected_class;
            
            // Fix confidence data access
            const confidence = data.confidence || {};
            confidenceScore.textContent = confidence.score || 'N/A';
            confidenceLevel.textContent = confidence.level || 'N/A';
            
            timestamp.textContent = formatTimestamp(data.timestamp);
            filename.textContent = data.filename;
            
            // Set confidence badge
            const confidenceLevelText = confidence.level || 'Medium Confidence';
            confidenceBadge.textContent = confidenceLevelText;
            confidenceBadge.className = 'text-xs font-bold px-3 py-1.5 rounded-full text-white shadow-lg ';
            if (confidenceLevelText.includes('High')) {
                confidenceBadge.classList.add('confidence-high');
            } else if (confidenceLevelText.includes('Medium')) {
                confidenceBadge.classList.add('confidence-medium');
            } else {
                confidenceBadge.classList.add('confidence-low');
            }
            
            // Medicinal Properties Information
            const medicinalProps = data.medicinal_properties;
            
            // Ayurvedic Properties
            ayurvedicProperties.innerHTML = '';
            if (data.ayurvedic_properties) {
                Object.entries(data.ayurvedic_properties).forEach(([key, value]) => {
                    const propElement = document.createElement('div');
                    propElement.className = 'text-center p-3 bg-gray-50 rounded-lg border border-gray-200';
                    propElement.innerHTML = `
                        <div class="text-gray-600 text-sm mb-1">${key}</div>
                        <div class="text-primary font-semibold">${value}</div>
                    `;
                    ayurvedicProperties.appendChild(propElement);
                });
            }
            
            // Medicinal Uses
            medicinalUses.innerHTML = '';
            if (medicinalProps && medicinalProps.medicinal_uses) {
                medicinalProps.medicinal_uses.forEach(use => {
                    const useElement = document.createElement('div');
                    useElement.className = 'medicine-item flex items-center space-x-3 p-3 rounded-lg cursor-pointer border border-gray-200';
                    useElement.innerHTML = `
                        <i class="fas fa-check-circle text-green-500 flex-shrink-0"></i>
                        <span class="text-primary">${use}</span>
                    `;
                    medicinalUses.appendChild(useElement);
                });
            }
            
            // Health Benefits
            healthBenefits.innerHTML = '';
            if (medicinalProps && medicinalProps.health_benefits) {
                medicinalProps.health_benefits.forEach(benefit => {
                    const benefitElement = document.createElement('div');
                    benefitElement.className = 'medicine-item flex items-center space-x-3 p-3 rounded-lg cursor-pointer border border-gray-200';
                    benefitElement.innerHTML = `
                        <i class="fas fa-star text-yellow-500 flex-shrink-0"></i>
                        <span class="text-primary">${benefit}</span>
                    `;
                    healthBenefits.appendChild(benefitElement);
                });
            }
            
            // How to Use
            howToUse.innerHTML = '';
            if (medicinalProps && medicinalProps.how_to_use) {
                medicinalProps.how_to_use.forEach(usage => {
                    const usageElement = document.createElement('div');
                    usageElement.className = 'medicine-item flex items-center space-x-3 p-3 rounded-lg cursor-pointer border border-gray-200';
                    usageElement.innerHTML = `
                        <i class="fas fa-leaf text-green-500 flex-shrink-0"></i>
                        <span class="text-primary">${usage}</span>
                    `;
                    howToUse.appendChild(usageElement);
                });
            }
            
            // Precautions
            precautions.innerHTML = '';
            if (medicinalProps && medicinalProps.precautions) {
                medicinalProps.precautions.forEach(precaution => {
                    const precautionElement = document.createElement('div');
                    precautionElement.className = 'medicine-item flex items-center space-x-3 p-3 rounded-lg cursor-pointer border border-gray-200';
                    precautionElement.innerHTML = `
                        <i class="fas fa-exclamation-triangle text-orange-500 flex-shrink-0"></i>
                        <span class="text-primary">${precaution}</span>
                    `;
                    precautions.appendChild(precautionElement);
                });
            }
            
            // Show confidence alert for low confidence
            if (confidenceLevelText.includes('Low')) {
                confidenceAlert.classList.remove('hidden');
                confidenceAlert.className = 'rounded-2xl p-5 border-2 animate-bounce-slow bg-yellow-50 border-yellow-400';
                confidenceAlert.innerHTML = `
                    <div class="flex items-center space-x-4">
                        <i class="fas fa-exclamation-triangle text-2xl text-yellow-600"></i>
                        <div>
                            <h4 class="font-bold text-yellow-800 text-lg">Low Confidence Result</h4>
                            <p class="text-yellow-700">Consider uploading a clearer image for better analysis</p>
                        </div>
                    </div>
                `;
            } else {
                confidenceAlert.classList.add('hidden');
            }
            
            // Animate result cards
            const resultCards = document.querySelectorAll('.result-card');
            resultCards.forEach((card, index) => {
                setTimeout(() => {
                    card.classList.add('show');
                }, index * 200);
            });
        }
        
        async function loadModelInfo() {
            try {
                modelStatus.innerHTML = '<span class="text-yellow-600">⏳ Loading...</span>';
                
                const response = await fetch(`${API_BASE}/model-info`);
                const data = await response.json();
                
                if (data.status === 200) {
                    // Update model status with color coding
                    if (data.model_loaded) {
                        modelStatus.innerHTML = '<span class="text-green-600">✅ Loaded</span>';
                        modelStatus.className = 'font-semibold';
                    } else {
                        modelStatus.innerHTML = '<span class="text-red-600">❌ Not Loaded</span>';
                        modelStatus.className = 'font-semibold';
                    }
                    
                    // Update classes count
                    modelClasses.textContent = data.available_classes ? data.available_classes.length : '0';
                    
                    // Update accuracy
                    if (data.training_info && data.training_info.test_accuracy) {
                        modelAccuracy.textContent = (data.training_info.test_accuracy * 100).toFixed(1) + '%';
                    } else {
                        modelAccuracy.textContent = 'N/A';
                    }
                    
                    // Update training date
                    if (data.training_info && data.training_info.timestamp) {
                        modelTrained.textContent = formatDate(data.training_info.timestamp);
                    } else {
                        modelTrained.textContent = 'N/A';
                    }
                    
                    // Update medicinal plants count
                    medicinalPlantsCount.textContent = data.total_medicinal_plants || '6';
                    
                } else {
                    throw new Error(data.message || 'Failed to load model info');
                }
            } catch (error) {
                console.error('Error loading model info:', error);
                modelStatus.innerHTML = '<span class="text-red-600">❌ Error Loading</span>';
                modelClasses.textContent = '-';
                modelAccuracy.textContent = '-';
                modelTrained.textContent = '-';
                medicinalPlantsCount.textContent = '-';
            }
        }
        
        function resetAnalysis() {
            // Reset file input
            fileInput.value = '';
            imagePreview.classList.add('hidden');
            predictBtn.disabled = true;
            
            // Hide results, show empty state
            resultsContent.classList.add('hidden');
            emptyState.classList.remove('hidden');
            confidenceAlert.classList.add('hidden');
            
            showSuccess('Ready for new analysis! 📸');
        }
        
        function saveReport() {
            showSuccess('Report saved successfully! 📄');
        }
        
        async function checkAPIHealth() {
            try {
                const response = await fetch(`${API_BASE}/health`);
                const data = await response.json();
                
                healthStatus.className = 'w-4 h-4 rounded-full pulse-glow ';
                if (data.status === 'healthy' && data.model_loaded) {
                    healthStatus.classList.add('bg-green-500');
                    healthText.textContent = 'Healthy & Ready';
                } else if (data.status === 'healthy') {
                    healthStatus.classList.add('bg-yellow-500');
                    healthText.textContent = 'Healthy (No Model)';
                } else {
                    healthStatus.classList.add('bg-red-500');
                    healthText.textContent = 'Unhealthy';
                }
            } catch (error) {
                healthStatus.className = 'w-4 h-4 rounded-full bg-red-500 pulse-glow';
                healthText.textContent = 'Offline';
            }
        }
        
        function showToast(message) {
            const toastMessage = document.getElementById('toast-message');
            toastMessage.textContent = message;
            toast.classList.remove('hidden', 'translate-y-16');
            toast.classList.add('animate-slide-in-right');
            
            setTimeout(() => {
                toast.classList.add('translate-y-16');
                setTimeout(() => {
                    toast.classList.remove('animate-slide-in-right');
                    toast.classList.add('hidden');
                }, 500);
            }, 5000);
        }
        
        function showSuccess(message) {
            const successMessage = document.getElementById('success-message');
            successMessage.textContent = message;
            successToast.classList.remove('hidden', 'translate-y-16');
            successToast.classList.add('animate-slide-in-right');
            
            setTimeout(() => {
                successToast.classList.add('translate-y-16');
                setTimeout(() => {
                    successToast.classList.remove('animate-slide-in-right');
                    successToast.classList.add('hidden');
                }, 500);
            }, 3000);
        }
        
        function formatTimestamp(timestamp) {
            const date = new Date(timestamp);
            return date.toLocaleString();
        }
        
        function formatDate(timestamp) {
            const date = new Date(timestamp);
            return date.toLocaleDateString();
        }
        
        function createFloatingShapes() {
            const shapesContainer = document.querySelector('.floating-shapes');
            for (let i = 0; i < 8; i++) {
                const shape = document.createElement('div');
                shape.className = 'floating-shape';
                shape.style.width = `${Math.random() * 100 + 50}px`;
                shape.style.height = shape.style.width;
                shape.style.left = `${Math.random() * 100}%`;
                shape.style.top = `${Math.random() * 100}%`;
                shape.style.animationDelay = `${Math.random() * 5}s`;
                shape.style.animationDuration = `${Math.random() * 10 + 10}s`;
                shapesContainer.appendChild(shape);
            }
        }
        
        // Load model info when page loads
        document.addEventListener('DOMContentLoaded', function() {
            loadModelInfo();
        });
    </script>
</body>
</html>
